<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
<ui:composition template="/WEB-INF/template/main.xhtml">
    <ui:param name="title" value="#{labels.administration}"/>
    <ui:define name="content">
        <h2><h:outputText value="#{labels.user_management}"/></h2>
        <h:panelGroup>
            <h:outputLink value="search" styleClass="btn btn-secondary">
                ${labels.browse}
                <f:param name="q" value=""/>
                <f:param name="t" value="USER"/>
            </h:outputLink>
            <h:outputLink value="profile-edit" styleClass="btn btn-primary">
                ${labels.create}
                <f:param name="c" value="true"/>
            </h:outputLink>
        </h:panelGroup>

        <h2><h:outputText value="#{labels.organization_settings}"/></h2>
        <h:form id="f-organisation" enctype="multipart/form-data">
            <h:panelGrid columns="2">
                <h:outputLabel id="o-name" for="it-name" value="#{labels.name}"/>
                <h:inputText id="it-name" value="#{adminBacker.organization.name}" styleClass="form-control"/>
                <h:panelGroup/>
                <h:panelGroup>
                    <h:outputText id="ot-name-hint" value="#{labels.organization_name_hint}"
                                  styleClass="small form-text text-muted"/>
                    <h:message for="it-name"/>
                </h:panelGroup>


                <h:outputLabel id="o-logo" for="g-logo" value="#{labels.logo}"/>
                <h:panelGrid columns="1">
                    <!-- TODO upgrade to real image from DB -->
                    <h:graphicImage id="g-logo" library="images" name="bugger.png" width="100" height="100"/>
                    <h:inputFile id="i-logo" validator="imageValidator"
                                 valueChangeListener="#{adminBacker.uploadLogo}" styleClass="form-control-file"/>
                    <h:panelGroup>
                        <h:selectBooleanCheckbox id="s-remove-logo" valueChangeListener="#{adminBacker.removeLogo}"/>
                        <h:outputLabel id="o-remove-logo" for="s-remove-logo" value="#{labels.remove}"/>
                    </h:panelGroup>
                </h:panelGrid>
                <h:panelGroup/>
                <h:message for="i-logo"/>

                <h:outputLabel id="o-theme" for="s-theme" value="#{labels.theme}"/>
                <h:selectOneMenu id="s-theme" styleClass="form-control" value="#{adminBacker.organization.theme}">
                    <f:selectItems value="#{adminBacker.availableThemes}"/>
                </h:selectOneMenu>
                <h:panelGroup/>
                <h:message for="s-theme"/>

                <h:outputLabel id="o-imprint" for="it-imprint" value="#{labels.imprint}"/>
                <h:inputTextarea id="it-imprint" value="#{adminBacker.organization.imprint}" styleClass="form-control"/>
                <h:panelGroup/>
                <h:message for="it-imprint"/>

                <h:outputLabel id="o-privacy-policy" for="it-privacy-policy" value="#{labels.privacy_policy}"/>
                <h:inputTextarea id="it-privacy-policy" value="#{adminBacker.organization.privacyPolicy}"
                                 styleClass="form-control"/>
                <h:panelGroup/>
                <h:message for="it-privacy-policy"/>

                <h:outputLabel id="o-support-info" for="it-support-info" value="#{labels.support_info}"/>
                <h:inputTextarea id="it-support-info" value="#{adminBacker.organization.supportInfo}"
                                 styleClass="form-control"/>
                <h:panelGroup/>
                <h:message for="it-support-info"/>
            </h:panelGrid>
            <h:commandButton value="#{labels.save}" action="#{adminBacker.saveOrganization}"
                             styleClass="btn btn-primary"/>
        </h:form>

        <h2><h:outputText value="#{labels.configuration_settings}"/></h2>
        <h:form id="f-configuration">
            <h:panelGrid columns="2">
                <h:outputText value="#{labels.guest_reading}"/>
                <h:panelGroup>
                    <h:selectBooleanCheckbox id="s-guest-reading" value="#{adminBacker.configuration.guestReading}"
                                             styleClass="form-check-input"/>
                    <h:outputLabel id="o-guest-reading" for="s-guest-reading" value="#{labels.guest_reading_detail}"/>
                </h:panelGroup>

                <h:panelGroup/>
                <h:message for="s-guest-reading"/>
                <h:outputText value="#{labels.closed_report_posting}"/>
                <h:panelGroup>
                    <h:selectBooleanCheckbox id="s-closed-report-posting"
                                             value="#{adminBacker.configuration.closedReportPosting}"
                                             styleClass="form-check-input"/>
                    <h:outputLabel id="o-closed-report-posting" for="s-closed-report-posting"
                                   value="#{labels.closed_report_posting_detail}"/>
                </h:panelGroup>
                <h:panelGroup/>
                <h:message for="s-closed-report-posting"/>

                <h:outputLabel id="o-user-email-format" for="s-user-email-format" value="#{labels.user_email_format}"/>
                <h:inputText id="s-user-email-format" value="#{adminBacker.configuration.userEmailFormat}"
                             validator="regexValidator" styleClass="form-control"/>
                <h:panelGroup/>
                <h:message for="s-user-email-format"/>

                <h:outputLabel id="o-allowed-file-extensions" for="it-allowed-file-extensions"
                               value="#{labels.allowed_file_extensions}"/>
                <h:inputTextarea id="it-allowed-file-extensions"
                                 value="#{adminBacker.configuration.allowedFileExtensions}" styleClass="form-control"/>
                <h:panelGroup/>
                <h:message for="it-allowed-file-extensions"/>

                <h:outputLabel id="o-max-attachments-per-post" for="it-max-attachments-per-post"
                               value="#{labels.max_attachments_per_post}"/>
                <h:inputText id="it-max-attachments-per-post"
                             value="#{adminBacker.configuration.maxAttachmentsPerPost}" styleClass="form-control"/>
                <h:panelGroup/>
                <h:message for="it-max-attachments-per-post"/>

                <h:outputLabel id="o-voting-weight-definition" for="it-voting-weight-definition"
                               value="#{labels.voting_weight_definition}"/>
                <h:inputText id="it-voting-weight-definition"
                             value="#{adminBacker.configuration.votingWeightDefinition}" styleClass="form-control"/>
            </h:panelGrid>
            <h:commandButton value="#{labels.save}" action="#{adminBacker.saveConfiguration}"
                             styleClass="btn btn-primary"/>
        </h:form>
    </ui:define>
</ui:composition>
</html>